# üëâ Generic API

<div class="MainContainer">
  <div class="Introduction">
    <p>
      Generic API is an implementation of common rules when you're making an API.<br>
      This API template is ment for HTTP requests, as well as database implementation<br>
      using Express module. In general, it's made purely with NodeJS.
    </p>
    <p>
      Run `npm install` in order to locally install all dependencies. 
    </p>
    <div class="ListHeader">
      üí´ Available Features: üí´
    </div>
    <ol>
      <li>Configuration of projecs's environment</li>
      <li>Generation of SQL queries for database configuration</li>
      <li>Migration service</li>
      <li>Automatic model configuration</li>
      <li>Easy controller implemention</li>
    </ol>
  </div>

  <hr>

  <div class="Sections">
    <section class="Environment">
      <h3 class="SectionHeader">
        1. ‚öôÔ∏è Configuration of project's environment: ‚öôÔ∏è
      </h3>
      <div class="SectionBody">
        <p>
          You're able to set your environment variables by creating
          a .env file, were you're requested to inform the following 
          information:
        </p>
        <ul>
          <li>
            <strong>HOST</strong>
            <div class="ItemInfo">
              Your server's host, such as:
              localhost, 127.0.0.1, etc...
            </div>
          </li>
          <li>
            <strong>PORT</strong>
            <div class="ItemInfo">
              Your server's port, such as:
              3000, 3333, etc...
            </div>
          </li>
          <li>
            <strong>DATABASE</strong>
            <div class="ItemInfo">
              Your database type, such as:
              posgresql, mysql, etc...
            </div>
          </li>
          <li>
            <strong>DB_USER</strong>
            <div class="ItemInfo">
              Your database user name.
            </div>
          </li>
          <li>
            <strong>DB_PASSWORD</strong>
            <div class="ItemInfo">
              Your target database password.
            </div>
          </li>
          <li>
            <strong>DB_BASE</strong>
            <div class="ItemInfo">
              Your target database name.
            </div>
          </li>
          <li>
            <strong>DB_HOST</strong>
            <div class="ItemInfo">
              Your database host, such as:
              5432 (PostgreSQL default), or 
              3306 (MYSQL default)
            </div>
          </li>
          <li>
            <strong>DB_PORT</strong>
            <div class="ItemInfo">
              Your database port.
            </div>
          </li>
        </ul>
        <p>See `@/start/examples/.env.example` for more information</p>
      </div>
    </section>
    <hr>
    <section class="SQLQueries">
      <h3 class="SectionHeader">
        2. üìÇ Generation of SQL queries for database configuration üìÇ
      </h3>
      <div class="SectionBody">
        <p>
          SQL queries can be generated by writing a migration file, in:
          `@/app/database/migrations/migrationList`.
          You can see that file `1_create_migrationHistorySchema` is already
          implemented. That file will contain a register of all migrations that
          were already run.
        <p>
        <p>
          When creating a migration, it's recomended you follow a name pattern:
          <ul>
            <li>
              <strong>Create</strong>
              <div class="ItemInfo">
                Create prefix is used when you're implementing a knew
                table of feature in your database.
                <br> 
                Follows the pattern:
                {migration_number}_create_{details} 
                <br>
                Exemple: 2_create_userSchema
              </div>
            </li>
            <li>
              <strong>addInto</strong>
              <div class="ItemInfo">
                addInto prefix is used when you're addind data into a
                table with INSERT command, for example. 
                <br>
                Follows the pattern:
                {migration_number}_addInto_{details} 
                <br>
                Exemple: 3_addInto_userSchema
              </div>
            </li>
            <li>
              <strong>Remove</strong>
              <div class="ItemInfo">
                Remove prefix is used when you're deleting a
                table or a set of table data. 
                <br>
                Follows the pattern:
                {migration_number}_remove_{details} 
                <br>
                Exemple: 4_remove_dataFromUserSchema
              </div>
            </li>
            <li>
              <strong>Update</strong>
              <div class="ItemInfo">
                Update prefix is used when you're updating a
                set of table data. 
                <br>
                Follows the pattern:
                {migration_number}_update_{details} 
                <br>
                Exemple: 5_update_userSchema
              </div>
            </li>
            <li>
              <strong>Alter</strong>
              <div class="ItemInfo">
                Alter prefix is used when you're altering
                table specifications. 
                <br>
                Follows the pattern:
                {migration_number}_alter_{details} 
                <br>
                Exemple: 6_alter_userSchema
              </div>
            </li>
          </ul>
        </p>
        <div class="AditionalInfo">
          <p>
            Always, when creaing a SQL query file, be sure to specify
            the migration name. It's recomended you use the same name 
            as the file. 
            <br>
            ‚ùóIMPORTANT‚ùó: Be sure to never repeat migration names!
            <br>
            Check `@/app/start/examples/migrations.example`
            for more information.
          </p> 
        </div>
      </div>
    </section>
    <hr>
    <section class="MigrationService">
      <h3 class="SectionHeader">
        3. üì¶ Migration service üì¶
      </h3>
      <div class="SectionBody">
        <p>
          After creating a SQL Query, you have to run the migrations in order
          to apply your changes into the database. The migration commands are
          typed directly in the terminal, in projects root folder. The available
          commands are:
        </p>
        <ul>
          <li>
            <strong>runAll</strong>
            <div class="ItemInfo">
              runAll is used when youn want to apply all
              written migrations into the database. A log will be 
              displayed in the terminal after this command is executed.
              <br> 
              Follows the pattern:
              <br>
              `yarn migration runAll`
              <br>
              or, if you use npm:
              <br>
              `npm run migration runAll`
            </div>
          </li>
          <li>
            <strong>runOne</strong>
            <div class="ItemInfo">
              runOne is used when youn want to apply just one
              written migration into the database. Receives the migration
              name as parameter. A log will be displayed in the terminal 
              after this command is executed.
              <br> 
              Follows the pattern:
              <br>
              `yarn migration runOne 2_create_userSchema`
              <br>
              or, if you use npm:
              <br>
              `npm run migration runOne 2_create_userSchema`
            </div>
          </li>
          <li>
            <strong>dropAll</strong>
            <div class="ItemInfo">
              dropAll is used when youn want to undo all
              written migrations into the database. Be careful with
              this command and just use it when you really know what you 
              doing. You will erase all data in database that were applied 
              by migrations. A log will be displayed in the terminal 
              after this command is executed.
              <br> 
              Follows the pattern:
              <br>
              `yarn migration dropAll`
              <br>
              or, if you use npm:
              <br>
              `npm run migration dropAll`
            </div>
          </li>
          <li>
            <strong>dropOne</strong>
            <div class="ItemInfo">
              runOne is used when youn want to drop just one
              written migration from the database. Receives the migration
              name as parameter. A log will be displayed in the terminal 
              after this command is executed.
              <br> 
              Follows the pattern:
              <br>
              `yarn migration dropOne 2_create_userSchema`
              <br>
              or, if you use npm:
              <br>
              `npm run migration dropOne 2_create_userSchema`
            </div>
          </li>
          <li>
            <strong>dropLast</strong>
            <div class="ItemInfo">
              dropLast drops the last applied migration. 
              A log will be displayed in the terminal after 
              this command is executed.
              <br> 
              Follows the pattern:
              <br>
              `yarn migration dropLast`
              <br>
              or, if you use npm:
              <br>
              `npm run migration dropLast`
            </div>
          </li>
        </ul>
        <div class="AditionalInfo">
          <p>
            Check `@/app/start/examples/migrations.example`
            for more information.
          </p> 
        </div>
      </div>
    </section>
    <hr>
    <section class="ModelConfiguration">
      <h3 class="SectionHeader">
        4. üí° Automatic Model configuration üí°
      </h3>
      <div class="SectionBody">
        Using Generic API, you don't have to create a new
        Model file for each table. The Models are created as 
        instances everytime you create a Controller. A Model
        instance is created with some pre methods, such as:
        <ul>
          <li>
            <strong>index</strong>
            <div class="ItemInfo">
              Lists all data rows in a requested table.
            </div>
          </li>
          <li>
            <strong>store</strong>
            <div class="ItemInfo">
              Add a new data row in a specified table.
              <br>
              Takes data as parameter.
            </div>
          </li>
          <li>
            <strong>show</strong>
            <div class="ItemInfo">
              Displays a data row or a sets of rows that
              satisfies a conditional specified as parameter.
            </div>
          </li>
          <li>
            <strong>update</strong>
            <div class="ItemInfo">
              Updates a data row or a sets of rows that
              satisfies a conditional specified as parameter.              
            </div>
          </li>
          <li>
            <strong>remove</strong>
            <div class="ItemInfo">
              Remove a data row or a sets of rows that
              satisfies a conditional specified as parameter.              
            </div>
          </li>
        </ul>
      </div>
    </section>
    <section class="ControllerConfiguration">
      <h3 class="SectionHeader">
        5. üõ†Ô∏è Easy Controller implemention üõ†Ô∏è
      </h3>
      <div class="SectionBody">
        <p>
          When creaing a new controller, there is some things you have to 
          specify, such as:
        </p>
        <ul>
          <li>
            <strong>Model</strong>
            <div class="ItemInfo">
              In global scope, define your models instace. 
              The Model class takes as parameters the table name, table main identifier
              (such as id, uuid or slug) and an array of not required fields. if not required
              fields parameter is not provided, only id column will be automatically choosed as
              not required.
              <br>
              Example:
              <br>
              const UserModel = new Model('users', 'id', ['description'])
            </div>
          </li>
          <li>
            <strong>setRoutes</strong>
            <div class="ItemInfo">
              setRoutes object this set the routes for each method of your controller.
              If none is specified, the default routes for the default methods will be:
              <br>
              {
                <br>
                index: '/index',
                <br>
                show: 'show/:slug',
                <br>
                store: 'store',
                <br>
                update: 'update/:slug',
                <br>
                remove: 'remove/:slug'
                <br>
              }
              <br>
              Notice that the default routes suppose you have a "slug" column
              as main identifier. If you don't, please change it or the application
              will be confused and won't work properly.
              <br>
              ‚ùóIMPORTANT‚ùó: As shown in default routes, when you want to specify url params,
              you should use Express's default, which is :{var_name}
            </div>
          </li>
          <li>
            <strong>routes</strong>
            <div class="ItemInfo">
              If you want to create new methods, you should create them
              inside the "routes" method as the example in `@/app/start/examples/controllers.example.js`
              <br>
            </div>
          </li>
          <li>
            <strong>update</strong>
            <div class="ItemInfo">
              Updates a data row or a sets of rows that
              satisfies a conditional specified as parameter.              
            </div>
          </li>
          <li>
            <strong>remove</strong>
            <div class="ItemInfo">
              Remove a data row or a sets of rows that
              satisfies a conditional specified as parameter.              
            </div>
          </li>
        </ul>
        <p>
          Remember to export your controller after the implementation.
          <br>
          Check `@/app/start/examples/controller.example.js` for more information.
        </p>
      </div>
    </section>
  </div>
</div>
